/*!component-m-flick v1.0.0 | NHN Entertainment*/
!function(){ne.util.defineNamespace("ne.component.m"),ne.component.m.Flicking=ne.util.defineClass({isMagnetic:!0,template:"<div>{{data}}</div>",itemClass:"panel",itemTag:"div",flow:"horizontal",isCircular:!0,isFixedHTML:!0,flickRange:50,effect:"linear",duration:100,init:function(a){this.element=a.element,this.wrapper=a.wrapper,this.itemTag=a.itemTag||this.itemTag,this.itemClass=a.itemClass||this.itemClass,this.template=a.template||this.template,this.flow=a.flow||this.flow,this.isMagnetic=ne.util.isExisty(a.isMagnetic)?a.isMagnetic:this.isMagnetic,this.isCircular=ne.util.isExisty(a.isCircular)?a.isCircular:this.isCircular,this.isFixedHTML=ne.util.isExisty(a.isFixedHTML)?a.isFixedHTML:this.isFixedHTML,this.effect=a.effect||this.effect,this.flickRange=a.flickRange||this.flickRange,this.duration=a.duration||this.duration,this.startPos={},this.savePos={},this._setConfig(),this.isFixedHTML||this._makeItems(a.data||""),this._initHelpers(),this._initElements(),this._initWrap(),this._attachEvent()},_setConfig:function(){var a="vertical"===this.flow;a?this._config={direction:["N","S"],way:"top",dimension:"height",point:"y",width:this.element.clientHeight}:this._config={direction:["W","E"],way:"left",dimension:"width",point:"x",width:this.element.clientWidth}},_initHelpers:function(){this.mover=new ne.component.MoveAnimator({flow:this.flow,element:this.wrapper,effect:this.effect,duration:this.duration}),this.movedetect=new ne.component.MoveDetector({flickRange:this.flickRange})},_initWrap:function(){var a=this._config;this.wrapper.style[a.way]="0px",this.wrapper.style[a.dimension]=a.width*this.elementCount+"px"},_initElements:function(){this.elementCount=0,ne.util.forEachArray(this.wrapper.children,function(a){1===a.nodeType&&(a.style.width=this._config.width+"px",this.elementCount+=1)},this)},_attachEvent:function(){this.onTouchMove=ne.util.bind(this._onTouchMove,this),this.onTouchEnd=ne.util.bind(this._onTouchEnd,this),this.element.addEventListener("touchstart",ne.util.bind(this.onTouchStart,this))},_makeItems:function(a){var b=this._getElement(a);this.wrapper.appendChild(b)},_getElement:function(a){var b=document.createElement(this.itemTag);return b.className=this.itemClass,b.innerHTML=a,b.style[this._config.dimension]=this._config.width+"px",b},onTouchStart:function(a){this.isLocked||(this.fire("beforeMove",this),this.isFixedHTML&&this.isCircular&&this._prepareMoveElement(),this._saveTouchStartData(a.touches[0]),document.addEventListener("touchmove",this.onTouchMove),document.addEventListener("touchend",this.onTouchEnd))},_onTouchMove:function(a){var b,c,d,e=this.startPos;a.preventDefault(),this.savePos.x=a.touches[0].clientX,this.savePos.y=a.touches[0].clientY,"horizontal"===this.flow?(c=e.x,d=this.savePos.x):(c=e.y,d=this.savePos.y),b=d-c,this.wrapper.style[this._config.way]=e[this._config.way]+b+"px"},_onTouchEnd:function(){var a=this._config.point;this.startPos[a]===this.savePos[a]?this._resetMoveElement():this.isMagnetic&&this._activeMagnetic(),document.removeEventListener("touchMove",this.onTouchMove),document.removeEventListener("touchEnd",this.onTouchEnd)},_saveTouchStartData:function(a){this.startPos[this._config.way]=this._getElementPos(),this.savePos.x=this.startPos.x=a.clientX,this.savePos.y=this.startPos.y=a.clientY,this.startPos.time=(new Date).getTime()},_prepareMoveElement:function(){this._setClone(),this._setPrev(),this._setNext()},_resetMoveElement:function(){var a="none";this.isFixedHTML?this.isCircular&&this._removeClones({way:a}):this._removePadding({way:a})},_activeMagnetic:function(){this._fixInto({x:this.savePos.x,y:this.savePos.y,start:this.startPos.time,end:(new Date).getTime()})},setPrev:function(a){var b=this._config,c=this._getElement(a);this.expandMovePanel(),this.wrapper.style[b.way]=this._getElementPos()-b.width+"px",this.wrapper.insertBefore(c,this.wrapper.firstChild)},setNext:function(a){var b=this._getElement(a);this.expandMovePanel(),this.wrapper.appendChild(b)},_setClone:function(){var a=0;this.clones=ne.util.filter(this.wrapper.children,function(b){return 1===b.nodeType?(a+=1,!0):void 0}),this.clones.count=a},_setPrev:function(){var a=1,b=this.clones,c=b.count,d=this._config,e=d.width*c,f=this.wrapper;for(ne.util.isHTMLTag(f.firstChild)||this.wrapper.removeChild(f.firstChild);c>=a;a++)f.insertBefore(b[c-a].cloneNode(!0),f.firstChild);f.style[d.dimension]=this._getWidth()+e+"px",f.style[d.way]=this._getElementPos()-e+"px"},_setNext:function(){for(var a=this.clones,b=a.count,c=this._config,d=c.width*b,e=this.wrapper,f=0;b>f;f++)e.appendChild(a[f].cloneNode(!0));e.style[c.dimension]=this._getWidth()+d+"px"},expandMovePanel:function(){this.wrapper.style[this._config.dimension]=this._getWidth()+this._config.width+"px"},reduceMovePanel:function(){this.wrapper.style[this._config.dimension]=this._getWidth()-this._config.width+"px"},_isFlick:function(a){var b={list:[this.startPos,this.savePos]};return ne.util.extend(b,a),this.movedetect.extractType(b),"flick"===this.movedetect.type},_fixInto:function(a){var b,c=this._isBackward(),d=this._isFlick(a),e=this.startPos[this._config.way];!d||this._isEdge(a)?(c=!c,b=this._getReturnPos(c),b.recover=!0):b=this._getCoverPos(c,e),this._moveTo(b,c)},_moveTo:function(a,b){var c=b?"backward":"forward",d=this.startPos[this._config.way],e=this._getMoved(),f=d+e;a.way=c,this.mover.setDistance(a.dist),this.mover.action({direction:c,start:f,complete:ne.util.bind(this._complete,this,a,a.cover)})},_complete:function(a,b){b?this.fire("afterFlick",a):this.fire("returnFlick",a),this.isLocked=!1,this.wrapper.style[this._config.way]=a.dest+"px",this.isFixedHTML?this.isCircular&&this._removeClones(a):this._removePadding(a)},_removeClones:function(a){console.log(this.clones);var b,c=this.clones.count,d=2*c,e=c,f=this._config,g=a.recover?"none":a.way;"forward"===g?e=c+1:"backward"===g&&(e=c-1),b=d-e,this._removeCloneElement(e,"firstChild"),this._removeCloneElement(b,"lastChild"),this.wrapper.style[f.dimension]=this._getWidth()-f.width*d+"px",this.wrapper.style[f.way]=0},_removeCloneElement:function(a,b){for(var c=0,d=this.wrapper;a>c;c++)1===d[b].nodeType?d.removeChild(d[b]):(d.removeChild(d[b]),c-=1)},_removePadding:function(a){var b=this.wrapper.getElementsByTagName(this.itemTag),c=b[0],d=b[b.length-1],e=this._config,f=a.recover?"none":a.way,g=this.wrapper;"forward"===f?d=b[1]:"backward"===f&&(c=b[1]),g.removeChild(c),g.removeChild(d),g.style[e.way]="0px",g.style[e.dimension]=this._getWidth()-2*e.width+"px"},_getReturnPos:function(a){var b=this._getMoved();return{dest:this.startPos[this._config.way],dist:a?b:-b,cover:!1}},_getCoverPos:function(a,b){var c=this._getMoved(),d={cover:!0};return a?(d.dist=-this._config.width+c,d.dest=b+this._config.width):(d.dist=-this._config.width-c,d.dest=b-this._config.width),d},_getMoved:function(){var a="horizontal"===this.flow?this.startPos.x:this.startPos.y,b="horizontal"===this.flow?this.savePos.x:this.savePos.y,c=b-a;return c},_isEdge:function(){if(this.isCircular)return!1;var a=!this._isBackward(),b=this._getElementPos(),c=this._getWidth();return a&&b<=-c+this._config.width?!0:!a&&b>0},_getWidth:function(){return parseInt(this.wrapper.style[this._config.dimension],10)},_getElementPos:function(){return parseInt(this.wrapper.style[this._config.way],10)},_isBackward:function(){var a=this.movedetect.getDirection([this.savePos,this.startPos]);return a===this._config.direction[0]}}),ne.util.CustomEvents.mixin(exports.Flicking)}();
//# sourceMappingURL=flicking.min.map